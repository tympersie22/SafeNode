# SafeNode Backend Environment Variables
# Copy this file to .env and fill in your values

# ============================================
# Server Configuration
# ============================================
NODE_ENV=development
PORT=4000

# ============================================
# Database Configuration
# ============================================
# Default: Prisma (PostgreSQL)
# Options: 'prisma' (PostgreSQL/MySQL), 'mongo' (MongoDB), 'file' (in-memory)
DB_ADAPTER=prisma

# PostgreSQL connection string (required for Prisma)
# Dedicated Supabase pooler format (recommended for production on Vercel):
# postgres://postgres:[YOUR-PASSWORD]@db.ohzfyxtxffvnzyhkaihs.supabase.co:6543/postgres?sslmode=require
# Local example:
DATABASE_URL=postgresql://postgres:password@localhost:5432/safenode

# Optional Vercel/Supabase Postgres variables (auto-fallback if DATABASE_URL is not set)
# Prefer dedicated pooler URL for app runtime:
# POSTGRES_PRISMA_URL=postgres://postgres:[YOUR-PASSWORD]@db.ohzfyxtxffvnzyhkaihs.supabase.co:6543/postgres?sslmode=require
# Optional direct URL for migrations:
# POSTGRES_URL_NON_POOLING=postgres://...:5432/postgres?sslmode=require
# POSTGRES_URL=postgres://...:6543/postgres?sslmode=require

# ============================================
# Seeding Configuration
# ============================================
# SEED_ON_BOOT - Force seed on boot (even if DB has users)
# Set to 'true' to always seed demo user on startup
SEED_ON_BOOT=true

# MongoDB connection string (only if using MongoDB adapter)
# MONGO_URI=mongodb://localhost:27017/safenode

# ============================================
# Security Configuration
# ============================================
# JWT Secret - REQUIRED in production
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
JWT_SECRET=your-jwt-secret-here-change-in-production

# JWT Expiration (optional, default: 24h)
# JWT_EXPIRES_IN=24h

# Password Pepper - Optional but recommended for stable password hashing
# If set, this is prepended to passwords before hashing
# Changing this invalidates all existing password hashes (users must reset passwords)
# Keep this constant in development to avoid login issues
PASSWORD_PEPPER=dev-pepper

# Encryption Key (optional but recommended for production)
# 32-byte base64-encoded key for encrypting vault data at rest
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# ENCRYPTION_KEY=your-encryption-key-here

# ============================================
# CORS Configuration
# ============================================
# Frontend URL(s) - comma-separated for multiple origins
# In development, localhost is allowed by default
# In production, set this to your frontend domain(s)
FRONTEND_URL=http://localhost:5173
# Optional: force OAuth callback base URL (use your canonical public domain in production)
# SSO_CALLBACK_BASE_URL=https://safe-node.app
# CORS_ORIGIN=https://safe-node.app,https://www.safe-node.app

# ============================================
# Rate Limiting
# ============================================
# Maximum requests per window (default: 100)
RATE_LIMIT_MAX=100
# Time window in minutes (default: 15)
RATE_LIMIT_WINDOW_MINUTES=15

# ============================================
# Stripe Configuration (for billing)
# ============================================
# Stripe Secret Key (required for billing features)
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here

# Stripe Webhook Secret (required for webhook verification)
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Stripe Price IDs (required for checkout + plan mapping)
# STRIPE_PRICE_INDIVIDUAL_MONTHLY=price_...
# STRIPE_PRICE_INDIVIDUAL_ANNUAL=price_...
# STRIPE_PRICE_FAMILY_MONTHLY=price_...
# STRIPE_PRICE_FAMILY_ANNUAL=price_...
# STRIPE_PRICE_TEAMS_MONTHLY=price_...
# STRIPE_PRICE_TEAMS_ANNUAL=price_...
# Optional legacy single-price vars (backward compatibility):
# STRIPE_PRICE_INDIVIDUAL=price_...
# STRIPE_PRICE_FAMILY=price_...
# STRIPE_PRICE_TEAMS=price_...

# ============================================
# Sentry Configuration (error tracking)
# ============================================
# Sentry DSN (optional but recommended for production)
# Get from: https://sentry.io/settings/projects/
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# SENTRY_DSN_BACKEND=https://your-sentry-dsn@sentry.io/project-id

# Enable Sentry in development (optional, default: false)
# SENTRY_ENABLED_IN_DEV=false

# ============================================
# Email Configuration (optional)
# ============================================
# SMTP settings for sending verification emails
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASS=your-app-password
# SMTP_FROM=noreply@safe-node.app

# ============================================
# SSO Configuration (optional)
# ============================================
# Google OAuth (optional)
# GOOGLE_CLIENT_ID=your-google-client-id
# GOOGLE_CLIENT_SECRET=your-google-client-secret

# GitHub OAuth (optional)
# GITHUB_CLIENT_ID=your-github-client-id
# GITHUB_CLIENT_SECRET=your-github-client-secret

# ============================================
# Railway/Production Notes
# ============================================
# In production on Railway:
# 1. Set NODE_ENV=production
# 2. Provide DATABASE_URL from Railway PostgreSQL service
# 3. Set strong JWT_SECRET (32+ characters)
# 4. Set ENCRYPTION_KEY for vault encryption
# 5. Set CORS_ORIGIN to your production frontend URL
# 6. Set STRIPE_SECRET_KEY and STRIPE_WEBHOOK_SECRET
# 7. Set SENTRY_DSN for error tracking
